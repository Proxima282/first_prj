from Notes import*
import json

notes = dict()
try:
    with open("data.json","r",encoding="utf - 8") as file:
            notes = json.load(file)

except:
    print("Такого файлу не існує ")

def show_note():
    textEdit.clear
    key = listNotes.selectedItems()[0].text() #Отримати назву замітки,яку треба відобразити 
    textEdit.setText(notes[key]["текст"])#За ключами отримати текст замітки і вставити у її віджет


def add_note():
    note_name, ok = QInputDialog.getText(mw,"Додати замітку","Назва замітки")#Діалогове вікно створення нової замітки 
    if ok and note_name != "": #чи ми ввели назву замітки і натиснули ок
        notes[note_name] = {"текст":"","теги":[]}#Створюється струткура заітки з назвою
        listNotes.addItem(note_name)#назва замітки поміщається у віджет списку заміток
        listTags.addItems(notes[note_name]["теги"])#теги замітки поміщається у список тегів
        print(notes)

def save_note():
    if listNotes.selectedItems():
        key = listNotes.selectedItems()[0].text()#отриууємо назви замітки яку ми отримаємо
        notes[key]["текст"] = textEdit.toPlainText()#отримуємо текст замітки
        with open("data.json","w",encoding="utf-8")as file:
            json.dump(notes,file,sort_keys=True,ensure_ascii=False)
    else:
        print("Ви не вибрали замітку")

def del_note():
    if listNotes.selectedItems:
        key = listNotes.selectedItems()[0].text()#отримуємо назву замітки 
        del notes[key]#Видаляємо елементи словника за ключем
        listNotes.clear
        listTags.clear()
        textEdit.clear()
        #Оновлюємо віджет
        listNotes.addItems(notes)
        with open("data.json","w",encoding="utf-8") as file:
            json.dump(notes,file,sort_keys=True,ensure_ascii=False)
    else:
        print("Ви не вибрали замітку!")

btn_createNote.clicked.connect(add_note)
btn_saveNote.clicked.connect(save_note)
btn_deleteNote.clicked.connect(del_note)
listNotes.itemClicked.connect(show_note)

mw.show()
app.exec()



